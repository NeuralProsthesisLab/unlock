<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>The Unlock Project: unlock/bci/decode/old/LRFB_3.m File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="namespaces.html"><span>Packages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<h1>unlock/bci/decode/old/LRFB_3.m File Reference</h1>  </div>
</div>
<div class="contents">
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="_calibrate___l_r_f_b_8m.html#a2420833d971716e9bab41cc9fb3abba1">function</a> LRFB_3()%Version 3&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_l_r_f_b__3_8m.html#a82295eaa1dd1ac58606f3ace468ec248">delete</a> (timerfindall)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">interface with nidaq or&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_l_r_f_b__3_8m.html#ae4d93640befc83bfe5b234b807ddae84">winsound</a> (guessing) if~isempty(findstr('nidaq'</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_l_r_f_b__3_8m.html#acf045f8b563c23c39509eb1a9be9800b">addchannel</a> (<a class="el" href="_l_r_f_b__3_8m.html#ad10e0d7b5cffc3ec9200126b0128aaae">ai</a>, <a class="el" href="_l_r_f_b__3_8m.html#ad10e0d7b5cffc3ec9200126b0128aaae">options.ai</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_l_r_f_b__3_8m.html#a416512fb38b273539b64c35b1d3f6499">set</a> (<a class="el" href="_l_r_f_b__3_8m.html#ad10e0d7b5cffc3ec9200126b0128aaae">ai</a>,'InputType','SingleEnded')</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_l_r_f_b__3_8m.html#aefa122779d303b132fe84d94bd5a6429">set</a> (<a class="el" href="_l_r_f_b__3_8m.html#ad10e0d7b5cffc3ec9200126b0128aaae">ai</a>,'LoggingMode','Memory') setverify(ai.Channel</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">elseif&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_l_r_f_b__3_8m.html#ad047fde62e6d1e5931b5976cb0a77c38">~isempty</a> (findstr('winsound', options.aidevice_name)) <a class="el" href="_l_r_f_b__3_8m.html#ad10e0d7b5cffc3ec9200126b0128aaae">ai</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_l_r_f_b__3_8m.html#ac8e2b3292fc41bb951be66d9de0ad8ec">h_rms</a> (<a class="el" href="_l_r_f_b__3_8m.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_l_r_f_b__3_8m.html#a6be5a31ddb7fa579e92040986b7a8746">h_filt</a> (<a class="el" href="_l_r_f_b__3_8m.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_l_r_f_b__3_8m.html#ab00b1c9bfafe77fb7e1a479a390f8434">h_text</a> (<a class="el" href="_l_r_f_b__3_8m.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_l_r_f_b__3_8m.html#a19fe2db3a716ae0a6c13056e153d5cd2">title</a> (['Channel ', num2str(<a class="el" href="_l_r_f_b__3_8m.html#ad10e0d7b5cffc3ec9200126b0128aaae">options.ai</a>(<a class="el" href="_l_r_f_b__3_8m.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>))])%legend('Raw data'</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">id&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_l_r_f_b__3_8m.html#aeddb8f85d4466703a9f8e8a0aadc6b27">bkg_color</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">calculates threshold from <br class="typebreak"/>
average of best calibrations&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_l_r_f_b__3_8m.html#aa2e7b7dc5900d4ea53b8c618b56f5e29">load</a> (sprintf('LRFBcalibration_%s%d_%d.mat', <a class="el" href="_l_r_f_b__3_8m.html#af0df3f4edea00b739f91ac1810bef3b8">cohort</a>, <a class="el" href="_l_r_f_b__3_8m.html#ac399c2ccc3e97e40664302b5d606ddac">subject_id</a>, <a class="el" href="_l_r_f_b__3_8m.html#aaf0628041c05fc1f7d40c8cb4a092708">calibration1</a>))</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_l_r_f_b__3_8m.html#a743c6ea64f996b234ecd168a5fde4113">load</a> (sprintf('LRFBcalibration_%s%d_%d.mat', <a class="el" href="_l_r_f_b__3_8m.html#af0df3f4edea00b739f91ac1810bef3b8">cohort</a>, <a class="el" href="_l_r_f_b__3_8m.html#ac399c2ccc3e97e40664302b5d606ddac">subject_id</a>, <a class="el" href="_l_r_f_b__3_8m.html#aed29ea98f3f1326561ef0da54d4f730f">calibration2</a>))</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_l_r_f_b__3_8m.html#aa698f2b93543ec8113a4513512278849">Screen</a> ('TextSize', wPtr, 72)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_l_r_f_b__3_8m.html#a2750e0b08d475486cfaed0c5c5f39e72">DrawFormattedText</a> (wPtr,'Start','center','center', <a class="el" href="_l_r_f_b__3_8m.html#a0f699a39e02b66ae6fbc4ef115970527">wait_color</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_l_r_f_b__3_8m.html#a409db32a75c796632f4a9d46258e1c9f">Screen</a> (wPtr,'Flip')</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">end&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_l_r_f_b__3_8m.html#a7278d715788d9a47f1a882ee648334e3">Screen</a> ('FillRect', wPtr, bkg_color)</td></tr>
<tr><td colspan="2"><h2><a name="var-members"></a>
Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">clear&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_l_r_f_b__3_8m.html#a00a349297fa58bc80ff5329e25dcfe28">all</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_l_r_f_b__3_8m.html#a02eacfd40be9042ceb0f07547365203d">options</a> = paramSetupLRFB</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">pulls up GUI CHANGE EACH TIME&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_l_r_f_b__3_8m.html#ac399c2ccc3e97e40664302b5d606ddac">subject_id</a> = options.subject_ID</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_l_r_f_b__3_8m.html#aaf0628041c05fc1f7d40c8cb4a092708">calibration1</a> = <a class="el" href="_l_r_f_b__3_8m.html#aaf0628041c05fc1f7d40c8cb4a092708">options.calibration1</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_l_r_f_b__3_8m.html#aed29ea98f3f1326561ef0da54d4f730f">calibration2</a> = <a class="el" href="_l_r_f_b__3_8m.html#aed29ea98f3f1326561ef0da54d4f730f">options.calibration2</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_l_r_f_b__3_8m.html#a17afa58b2bc574dedcd1cc02e1fdf165">block</a> = <a class="el" href="_l_r_f_b__3_8m.html#a17afa58b2bc574dedcd1cc02e1fdf165">options.block</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_l_r_f_b__3_8m.html#af0df3f4edea00b739f91ac1810bef3b8">cohort</a> = 'CY'</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">timing definitions&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_l_r_f_b__3_8m.html#a57c08380e17d03eeac0cbe05897ce51d">sampleRate</a> = 4000</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">Hz&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_l_r_f_b__3_8m.html#a4ed458533229291abb09b25cce77d22f">dataRate</a> = 12</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">Hz&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_l_r_f_b__3_8m.html#a712d83341a3780129aeec4621fb1b139">filter_alpha</a> = .95</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">interface with nidaq or <br class="typebreak"/>
<a class="el" href="_l_r_f_b__3_8m.html#a02eacfd40be9042ceb0f07547365203d">options</a> aidevice_name&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_l_r_f_b__3_8m.html#ad10e0d7b5cffc3ec9200126b0128aaae">ai</a> = analoginput('nidaq','Dev1')</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_l_r_f_b__3_8m.html#a04e13ef5b9df2620f0659792293d94dd">actualRate</a> = setverify(<a class="el" href="_l_r_f_b__3_8m.html#ad10e0d7b5cffc3ec9200126b0128aaae">ai</a>,'SampleRate',<a class="el" href="_l_r_f_b__3_8m.html#a57c08380e17d03eeac0cbe05897ce51d">sampleRate</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="_l_r_f_b__3_8m.html#ad10e0d7b5cffc3ec9200126b0128aaae">ai</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_l_r_f_b__3_8m.html#a05b56bc109d79e5ad0860e4ff071e9d9">SamplesPerTrigger</a> = Inf</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_l_r_f_b__3_8m.html#ab6b390703e56224a87a7411e8ed88655">InputRange</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">else&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_l_r_f_b__3_8m.html#af7449f4e1bb7fd701d8a3ead5f0da5a1">return</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">end for loop to plot&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_l_r_f_b__3_8m.html#aefe64a2c84dd0b30f275d81504563b44">data</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">end for loop to plot&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_l_r_f_b__3_8m.html#afd1453cad6368d31b07391d3fad93f5d">RMF</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">end for loop to plot filter <br class="typebreak"/>
for each channel&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_l_r_f_b__3_8m.html#a452b745c8e9943e24f6ea44ad3126bd9">h_fig</a> = <a class="el" href="plot_dcd_trig_samp_8m.html#a93b0e7609865ad37daf5bb6b49d3ce40">figure</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">for&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_l_r_f_b__3_8m.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">hold&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_l_r_f_b__3_8m.html#a58ab1fd68e97078232808206b850161b">on</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_l_r_f_b__3_8m.html#a7bcc24c4bf38cb51a0dbc14e7cb1b1a9">RMS</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">Filtered end&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_l_r_f_b__3_8m.html#a7808395ca4c3cf5e653a06847bf824d2">commands</a> = {'Left','Right','Forward','Backward'}</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_l_r_f_b__3_8m.html#aef7ddecebe461a4a235f0e2094aa5b9f">nTrials</a> = 12</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">should <a class="el" href="set_unlock_params_8m.html#aeebc780ad292b8ff1c982e06baffc353">be</a> divisible by&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_l_r_f_b__3_8m.html#a2049522569a53f1bf217d1933e479ab2">nListReps</a> = ceil(<a class="el" href="_l_r_f_b__3_8m.html#aef7ddecebe461a4a235f0e2094aa5b9f">nTrials</a>/length(<a class="el" href="_l_r_f_b__3_8m.html#a7808395ca4c3cf5e653a06847bf824d2">commands</a>))</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_l_r_f_b__3_8m.html#a622badbc988ce65ebb3b4c1c8eb197b4">command_list</a> = repmat(<a class="el" href="_l_r_f_b__3_8m.html#a7808395ca4c3cf5e653a06847bf824d2">commands</a>',<a class="el" href="_l_r_f_b__3_8m.html#a2049522569a53f1bf217d1933e479ab2">nListReps</a>,1)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">randomizes&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_l_r_f_b__3_8m.html#a91106fc2280d1762b29c56f191342e79">reorder_idx</a> = randperm(size(<a class="el" href="_l_r_f_b__3_8m.html#a622badbc988ce65ebb3b4c1c8eb197b4">command_list</a>,1))</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_l_r_f_b__3_8m.html#a3b51c79a7f111d2be9d347ac9bfe3abd">win</a> = 1</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">is default&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_l_r_f_b__3_8m.html#a19d18510a1713030f345eb97dd5a573c">dims</a> = [0 0 500 500]</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_l_r_f_b__3_8m.html#a0f699a39e02b66ae6fbc4ef115970527">wait_color</a> = 255</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_l_r_f_b__3_8m.html#aae4c0f0e0235fec95d418ac53fe485b3">go_color</a> = [0 150 0]</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_l_r_f_b__3_8m.html#a1d78ecca9eead6e23fa63d37cbacd021">l_threshold</a> = <a class="el" href="_l_r_f_b__3_8m.html#ab46eeb0d31997a550d9c614012220383">max</a>(<a class="el" href="_calibrate___l_r_f_b_8m.html#acc96488446976d1b30ae76ca72ecb909">draw_rms</a>(:,1))</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_l_r_f_b__3_8m.html#a52027d4bb6d4a8d84b970aa2674b9f96">r_threshold</a> = <a class="el" href="_l_r_f_b__3_8m.html#ab46eeb0d31997a550d9c614012220383">max</a>(<a class="el" href="_calibrate___l_r_f_b_8m.html#acc96488446976d1b30ae76ca72ecb909">draw_rms</a>(:,2))</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_l_r_f_b__3_8m.html#a21a92e942778657a1903890410552a09">f_threshold</a> = <a class="el" href="_l_r_f_b__3_8m.html#ab46eeb0d31997a550d9c614012220383">max</a>(<a class="el" href="_calibrate___l_r_f_b_8m.html#acc96488446976d1b30ae76ca72ecb909">draw_rms</a>(:,3))</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_l_r_f_b__3_8m.html#a5aca3cfdfee68980538a2a1b58545654">wink_threshold</a> = <a class="el" href="_l_r_f_b__3_8m.html#ab46eeb0d31997a550d9c614012220383">max</a>(<a class="el" href="_calibrate___l_r_f_b_8m.html#acc96488446976d1b30ae76ca72ecb909">draw_rms</a>(:,4))</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">for bit calculations later&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_l_r_f_b__3_8m.html#aed9114e5a38b269f8d9e9fd2dd0e0718">nChoices</a> = length(<a class="el" href="_l_r_f_b__3_8m.html#a7808395ca4c3cf5e653a06847bf824d2">commands</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_l_r_f_b__3_8m.html#a378bba22dc311c92029e044abb0f7745">nCorrect</a> = 0</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_l_r_f_b__3_8m.html#a70ad662d5e697eaad0ee3afe3ea0b234">total_t</a> = 0</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_l_r_f_b__3_8m.html#aa38deece9821742b2aa3d7f5145c6414">STARTING</a> [wPtr, rect] = Screen('OpenWindow',<a class="el" href="_l_r_f_b__3_8m.html#a3b51c79a7f111d2be9d347ac9bfe3abd">win</a>,bkg_color,<a class="el" href="_l_r_f_b__3_8m.html#a19d18510a1713030f345eb97dd5a573c">dims</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_l_r_f_b__3_8m.html#a8fb092330ecda60587643305d0d9738a">tic</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">while toc&lt; 2endfor i=1:nTrials all_data=zeros(1, 4);all_t=[];draw_t=[];draw_rms=zeros(1, 4);draw_y=[];Screen('TextSize', wPtr, 72);DrawFormattedText(wPtr, char(command_list(i)),'center','center', wait_color);Screen(wPtr,'Flip');tic;while toc&lt; 2 end Screen('TextSize', wPtr, 72);DrawFormattedText(wPtr, char(command_list(i)),'center','center', go_color);t_start=Screen(wPtr,'Flip');tic;start(ai);t=0;while isrunning(ai)&amp;&amp;max(draw_rms(:, 4))&lt; wink_threshold[emg_data, emg_t]=getdata(ai, actualRate/dataRate);t=toc;%concatenate all data all_data=[all_data;emg_data];all_t=[all_t;emg_t];draw_t=[draw_t;t];if~exist('draw_rms','var') draw_rms=[];end draw_rms=[draw_rms;zeros(1, size(emg_data, 2))];for j=1:length(options.ai) draw_rms(end, j)=sqrt(mean(emg_data(:, j).^2));%draw_rms=[draw_rms;sqrt(mean(emg_data(:, 1).^2)) sqrt(mean(emg_data(:, 2).^2))];end if~isempty(draw_y) draw_y=[draw_y;filter_alpha *draw_y(end,:)+(1-filter_alpha)*(draw_rms(end,:))];else draw_y=draw_rms(end,:);end end given_command=command_list(i);stop(ai);nSamples=length(draw_rms);window_idx=floor(nSamples *.20);if window_idx==0 window_idx=1;end window=draw_rms(window_idx:end,:);%classifier if((max(window(:, 1)))&gt; l_threshold)&amp;&amp;((max(window(:, 2)))&lt; r_threshold)&amp;&amp;((max(window(:, 3)))&lt; f_threshold) movement= 'Left';elseif(max(window(:, 1))&lt; l_threshold)&amp;&amp;(max(window(:, 2))&gt; r_threshold)&amp;&amp;(max(window(:, 3))&lt; f_threshold) movement= 'Right';elseif(max(window(:, 1))&gt; l_threshold)&amp;&amp;(max(window(:, 2))&gt;r_threshold)&amp;&amp;(max(window(:, 3))&gt; f_threshold) movement= 'Forward';elseif(max(window(:, 1))&gt; l_threshold)&amp;&amp;(max(window(:, 2))&gt; r_threshold &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_l_r_f_b__3_8m.html#ab46eeb0d31997a550d9c614012220383">max</a> )(window(:, 3))&lt; <a class="el" href="_l_r_f_b__3_8m.html#a21a92e942778657a1903890410552a09">f_threshold</a>) <a class="el" href="_l_r_f_b__3_8m.html#a586fb139691a74f4c1d12aa1f303cf67">movement</a> = 'Backward'</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">else&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_l_r_f_b__3_8m.html#a586fb139691a74f4c1d12aa1f303cf67">movement</a> = 'Unknown'</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_l_r_f_b__3_8m.html#af5a50986527724aac6d11ec9465b5f39">t_end</a> = Screen(wPtr,'Flip')</td></tr>
</table>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="acf045f8b563c23c39509eb1a9be9800b"></a><!-- doxytag: member="LRFB_3.m::addchannel" ref="acf045f8b563c23c39509eb1a9be9800b" args="(ai, options.ai)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">addchannel </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_l_r_f_b__3_8m.html#ad10e0d7b5cffc3ec9200126b0128aaae">ai</a>&nbsp;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">options.&nbsp;</td>
          <td class="paramname"> <em>ai</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="aeddb8f85d4466703a9f8e8a0aadc6b27"></a><!-- doxytag: member="LRFB_3.m::bkg_color" ref="aeddb8f85d4466703a9f8e8a0aadc6b27" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">id bkg_color </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a82295eaa1dd1ac58606f3ace468ec248"></a><!-- doxytag: member="LRFB_3.m::delete" ref="a82295eaa1dd1ac58606f3ace468ec248" args="(timerfindall)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_calibrate___l_r_f_b_8m.html#a2420833d971716e9bab41cc9fb3abba1">function</a> LRFB_3 () % Version 3 delete </td>
          <td>(</td>
          <td class="paramtype">timerfindall&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a2750e0b08d475486cfaed0c5c5f39e72"></a><!-- doxytag: member="LRFB_3.m::DrawFormattedText" ref="a2750e0b08d475486cfaed0c5c5f39e72" args="(wPtr,'Start','center','center', wait_color)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">DrawFormattedText </td>
          <td>(</td>
          <td class="paramtype">wPtr&nbsp;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">'Start'&nbsp;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">'center'&nbsp;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">'center'&nbsp;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_l_r_f_b__3_8m.html#a0f699a39e02b66ae6fbc4ef115970527">wait_color</a>&nbsp;</td>
          <td class="paramname"></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a6be5a31ddb7fa579e92040986b7a8746"></a><!-- doxytag: member="LRFB_3.m::h_filt" ref="a6be5a31ddb7fa579e92040986b7a8746" args="(i)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">h_filt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_l_r_f_b__3_8m.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="ac8e2b3292fc41bb951be66d9de0ad8ec"></a><!-- doxytag: member="LRFB_3.m::h_rms" ref="ac8e2b3292fc41bb951be66d9de0ad8ec" args="(i)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">h_rms </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_l_r_f_b__3_8m.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="ab00b1c9bfafe77fb7e1a479a390f8434"></a><!-- doxytag: member="LRFB_3.m::h_text" ref="ab00b1c9bfafe77fb7e1a479a390f8434" args="(i)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">h_text </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_l_r_f_b__3_8m.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a743c6ea64f996b234ecd168a5fde4113"></a><!-- doxytag: member="LRFB_3.m::load" ref="a743c6ea64f996b234ecd168a5fde4113" args="(sprintf('LRFBcalibration_%s%d_%d.mat', cohort, subject_id, calibration2))" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">load </td>
          <td>(</td>
          <td class="paramtype">sprintf('LRFBcalibration_%s%d_%d.mat', <a class="el" href="_l_r_f_b__3_8m.html#af0df3f4edea00b739f91ac1810bef3b8">cohort</a>, <a class="el" href="_l_r_f_b__3_8m.html#ac399c2ccc3e97e40664302b5d606ddac">subject_id</a>, <a class="el" href="_l_r_f_b__3_8m.html#aed29ea98f3f1326561ef0da54d4f730f">calibration2</a>)&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="aa2e7b7dc5900d4ea53b8c618b56f5e29"></a><!-- doxytag: member="LRFB_3.m::load" ref="aa2e7b7dc5900d4ea53b8c618b56f5e29" args="(sprintf('LRFBcalibration_%s%d_%d.mat', cohort, subject_id, calibration1))" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">calculates threshold from average of best calibrations load </td>
          <td>(</td>
          <td class="paramtype">sprintf('LRFBcalibration_%s%d_%d.mat', <a class="el" href="_l_r_f_b__3_8m.html#af0df3f4edea00b739f91ac1810bef3b8">cohort</a>, <a class="el" href="_l_r_f_b__3_8m.html#ac399c2ccc3e97e40664302b5d606ddac">subject_id</a>, <a class="el" href="_l_r_f_b__3_8m.html#aaf0628041c05fc1f7d40c8cb4a092708">calibration1</a>)&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a409db32a75c796632f4a9d46258e1c9f"></a><!-- doxytag: member="LRFB_3.m::Screen" ref="a409db32a75c796632f4a9d46258e1c9f" args="(wPtr,'Flip')" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Screen </td>
          <td>(</td>
          <td class="paramtype">wPtr&nbsp;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">'Flip'&nbsp;</td>
          <td class="paramname"></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a7278d715788d9a47f1a882ee648334e3"></a><!-- doxytag: member="LRFB_3.m::Screen" ref="a7278d715788d9a47f1a882ee648334e3" args="('FillRect', wPtr, bkg_color)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">end Screen </td>
          <td>(</td>
          <td class="paramtype">'FillRect'&nbsp;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">wPtr&nbsp;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bkg_color&nbsp;</td>
          <td class="paramname"></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="aa698f2b93543ec8113a4513512278849"></a><!-- doxytag: member="LRFB_3.m::Screen" ref="aa698f2b93543ec8113a4513512278849" args="('TextSize', wPtr, 72)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Screen </td>
          <td>(</td>
          <td class="paramtype">'TextSize'&nbsp;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">wPtr&nbsp;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">72&nbsp;</td>
          <td class="paramname"></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a416512fb38b273539b64c35b1d3f6499"></a><!-- doxytag: member="LRFB_3.m::set" ref="a416512fb38b273539b64c35b1d3f6499" args="(ai,'InputType','SingleEnded')" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">set </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_l_r_f_b__3_8m.html#ad10e0d7b5cffc3ec9200126b0128aaae">ai</a>&nbsp;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">'InputType'&nbsp;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">'SingleEnded'&nbsp;</td>
          <td class="paramname"></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="aefa122779d303b132fe84d94bd5a6429"></a><!-- doxytag: member="LRFB_3.m::set" ref="aefa122779d303b132fe84d94bd5a6429" args="(ai,'LoggingMode','Memory') setverify(ai.Channel" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">set </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_l_r_f_b__3_8m.html#ad10e0d7b5cffc3ec9200126b0128aaae">ai</a>&nbsp;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">'LoggingMode'&nbsp;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">'Memory'&nbsp;</td>
          <td class="paramname"></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a19fe2db3a716ae0a6c13056e153d5cd2"></a><!-- doxytag: member="LRFB_3.m::title" ref="a19fe2db3a716ae0a6c13056e153d5cd2" args="(['Channel ', num2str(options.ai(i))])%legend('Raw data'" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">title </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="ae4d93640befc83bfe5b234b807ddae84"></a><!-- doxytag: member="LRFB_3.m::winsound" ref="ae4d93640befc83bfe5b234b807ddae84" args="(guessing) if~isempty(findstr('nidaq'" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">interface with nidaq or winsound </td>
          <td>(</td>
          <td class="paramtype">guessing&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="ad047fde62e6d1e5931b5976cb0a77c38"></a><!-- doxytag: member="LRFB_3.m::~isempty" ref="ad047fde62e6d1e5931b5976cb0a77c38" args="(findstr('winsound', options.aidevice_name)) ai" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">elseif ~isempty </td>
          <td>(</td>
          <td class="paramtype">findstr('winsound', options.aidevice_name)&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="a04e13ef5b9df2620f0659792293d94dd"></a><!-- doxytag: member="LRFB_3.m::actualRate" ref="a04e13ef5b9df2620f0659792293d94dd" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_l_r_f_b__3_8m.html#a04e13ef5b9df2620f0659792293d94dd">actualRate</a> = setverify(<a class="el" href="_l_r_f_b__3_8m.html#ad10e0d7b5cffc3ec9200126b0128aaae">ai</a>,'SampleRate',<a class="el" href="_l_r_f_b__3_8m.html#a57c08380e17d03eeac0cbe05897ce51d">sampleRate</a>)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="ad10e0d7b5cffc3ec9200126b0128aaae"></a><!-- doxytag: member="LRFB_3.m::ai" ref="ad10e0d7b5cffc3ec9200126b0128aaae" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">interface with nidaq or <a class="el" href="_l_r_f_b__3_8m.html#a02eacfd40be9042ceb0f07547365203d">options</a> aidevice_name <a class="el" href="_l_r_f_b__3_8m.html#ad10e0d7b5cffc3ec9200126b0128aaae">ai</a> = analoginput('nidaq','Dev1')</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a00a349297fa58bc80ff5329e25dcfe28"></a><!-- doxytag: member="LRFB_3.m::all" ref="a00a349297fa58bc80ff5329e25dcfe28" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">close <a class="el" href="_l_r_f_b__3_8m.html#a00a349297fa58bc80ff5329e25dcfe28">all</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a17afa58b2bc574dedcd1cc02e1fdf165"></a><!-- doxytag: member="LRFB_3.m::block" ref="a17afa58b2bc574dedcd1cc02e1fdf165" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_l_r_f_b__3_8m.html#a17afa58b2bc574dedcd1cc02e1fdf165">block</a> = <a class="el" href="_l_r_f_b__3_8m.html#a17afa58b2bc574dedcd1cc02e1fdf165">options.block</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="aaf0628041c05fc1f7d40c8cb4a092708"></a><!-- doxytag: member="LRFB_3.m::calibration1" ref="aaf0628041c05fc1f7d40c8cb4a092708" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_l_r_f_b__3_8m.html#aaf0628041c05fc1f7d40c8cb4a092708">calibration1</a> = <a class="el" href="_l_r_f_b__3_8m.html#aaf0628041c05fc1f7d40c8cb4a092708">options.calibration1</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="aed29ea98f3f1326561ef0da54d4f730f"></a><!-- doxytag: member="LRFB_3.m::calibration2" ref="aed29ea98f3f1326561ef0da54d4f730f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_l_r_f_b__3_8m.html#aed29ea98f3f1326561ef0da54d4f730f">calibration2</a> = <a class="el" href="_l_r_f_b__3_8m.html#aed29ea98f3f1326561ef0da54d4f730f">options.calibration2</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="af0df3f4edea00b739f91ac1810bef3b8"></a><!-- doxytag: member="LRFB_3.m::cohort" ref="af0df3f4edea00b739f91ac1810bef3b8" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_l_r_f_b__3_8m.html#af0df3f4edea00b739f91ac1810bef3b8">cohort</a> = 'CY'</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a622badbc988ce65ebb3b4c1c8eb197b4"></a><!-- doxytag: member="LRFB_3.m::command_list" ref="a622badbc988ce65ebb3b4c1c8eb197b4" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_l_r_f_b__3_8m.html#a622badbc988ce65ebb3b4c1c8eb197b4">command_list</a> = repmat(<a class="el" href="_l_r_f_b__3_8m.html#a7808395ca4c3cf5e653a06847bf824d2">commands</a>',<a class="el" href="_l_r_f_b__3_8m.html#a2049522569a53f1bf217d1933e479ab2">nListReps</a>,1)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a7808395ca4c3cf5e653a06847bf824d2"></a><!-- doxytag: member="LRFB_3.m::commands" ref="a7808395ca4c3cf5e653a06847bf824d2" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Filtered end <a class="el" href="_l_r_f_b__3_8m.html#a7808395ca4c3cf5e653a06847bf824d2">commands</a> = {'Left','Right','Forward','Backward'}</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="aefe64a2c84dd0b30f275d81504563b44"></a><!-- doxytag: member="LRFB_3.m::data" ref="aefe64a2c84dd0b30f275d81504563b44" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">end for loop to plot data</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a4ed458533229291abb09b25cce77d22f"></a><!-- doxytag: member="LRFB_3.m::dataRate" ref="a4ed458533229291abb09b25cce77d22f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Hz <a class="el" href="_l_r_f_b__3_8m.html#a4ed458533229291abb09b25cce77d22f">dataRate</a> = 12</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a19d18510a1713030f345eb97dd5a573c"></a><!-- doxytag: member="LRFB_3.m::dims" ref="a19d18510a1713030f345eb97dd5a573c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">is default <a class="el" href="_l_r_f_b__3_8m.html#a19d18510a1713030f345eb97dd5a573c">dims</a> = [0 0 500 500]</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a21a92e942778657a1903890410552a09"></a><!-- doxytag: member="LRFB_3.m::f_threshold" ref="a21a92e942778657a1903890410552a09" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_l_r_f_b__3_8m.html#a21a92e942778657a1903890410552a09">f_threshold</a> = <a class="el" href="_l_r_f_b__3_8m.html#ab46eeb0d31997a550d9c614012220383">max</a>(<a class="el" href="_calibrate___l_r_f_b_8m.html#acc96488446976d1b30ae76ca72ecb909">draw_rms</a>(:,3))</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a712d83341a3780129aeec4621fb1b139"></a><!-- doxytag: member="LRFB_3.m::filter_alpha" ref="a712d83341a3780129aeec4621fb1b139" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Hz <a class="el" href="_l_r_f_b__3_8m.html#a712d83341a3780129aeec4621fb1b139">filter_alpha</a> = .95</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="aae4c0f0e0235fec95d418ac53fe485b3"></a><!-- doxytag: member="LRFB_3.m::go_color" ref="aae4c0f0e0235fec95d418ac53fe485b3" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_l_r_f_b__3_8m.html#aae4c0f0e0235fec95d418ac53fe485b3">go_color</a> = [0 150 0]</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a452b745c8e9943e24f6ea44ad3126bd9"></a><!-- doxytag: member="LRFB_3.m::h_fig" ref="a452b745c8e9943e24f6ea44ad3126bd9" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">end for loop to plot filter for each channel <a class="el" href="_l_r_f_b__3_8m.html#a452b745c8e9943e24f6ea44ad3126bd9">h_fig</a> = <a class="el" href="plot_dcd_trig_samp_8m.html#a93b0e7609865ad37daf5bb6b49d3ce40">figure</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a6f6ccfcf58b31cb6412107d9d5281426"></a><!-- doxytag: member="LRFB_3.m::i" ref="a6f6ccfcf58b31cb6412107d9d5281426" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">for <a class="el" href="_l_r_f_b__3_8m.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Initial value:</b><div class="fragment"><pre class="fragment">1:<a class="code" href="trim_epochs_8m.html#aaef23c4dfb992ed0a66d2dad732a9f0d">length</a>(<a class="code" href="_calibrate___l_r_f_b_8m.html#a02eacfd40be9042ceb0f07547365203d">options</a>.ai)
%     <a class="code" href="plot_unlock_time_spec_8m.html#aa91585101679e3a1876aeddeb869df25">subplot</a>(<a class="code" href="trim_epochs_8m.html#aaef23c4dfb992ed0a66d2dad732a9f0d">length</a>(<a class="code" href="_calibrate___l_r_f_b_8m.html#a02eacfd40be9042ceb0f07547365203d">options</a>.ai),1,<a class="code" href="_calibrate___l_r_f_b_8m.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>)
%     h_raw(<a class="code" href="_calibrate___l_r_f_b_8m.html#a6f6ccfcf58b31cb6412107d9d5281426">i</a>) = <a class="code" href="anal_unlock_folder_files_8m.html#ac27bb1e0ad02a7bcfba72cc46e7da15c">plot</a>(0,0,<span class="charliteral">&#39;b&#39;</span>)
</pre></div>
</div>
</div>
<a class="anchor" id="ab6b390703e56224a87a7411e8ed88655"></a><!-- doxytag: member="LRFB_3.m::InputRange" ref="ab6b390703e56224a87a7411e8ed88655" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_l_r_f_b__3_8m.html#ab6b390703e56224a87a7411e8ed88655">InputRange</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a1d78ecca9eead6e23fa63d37cbacd021"></a><!-- doxytag: member="LRFB_3.m::l_threshold" ref="a1d78ecca9eead6e23fa63d37cbacd021" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_l_r_f_b__3_8m.html#a1d78ecca9eead6e23fa63d37cbacd021">l_threshold</a> = <a class="el" href="_l_r_f_b__3_8m.html#ab46eeb0d31997a550d9c614012220383">max</a>(<a class="el" href="_calibrate___l_r_f_b_8m.html#acc96488446976d1b30ae76ca72ecb909">draw_rms</a>(:,1))</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="ab46eeb0d31997a550d9c614012220383"></a><!-- doxytag: member="LRFB_3.m::max" ref="ab46eeb0d31997a550d9c614012220383" args=")(window(:, 3))&lt; f_threshold) movement" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">while toc&lt; 2endfor i = 1:nTrials all_data = zeros(1,4); all_t = []; draw_t = []; draw_rms = zeros(1,4); draw_y = []; Screen('TextSize',wPtr, 72); DrawFormattedText(wPtr,char(command_list(i)),'center','center',wait_color); Screen(wPtr,'Flip'); tic; while toc &lt; 2 end Screen('TextSize',wPtr, 72); DrawFormattedText(wPtr,char(command_list(i)),'center','center',go_color); t_start = Screen(wPtr,'Flip'); tic; start(ai); t = 0; while isrunning(ai) &amp;&amp; max(draw_rms(:,4)) &lt; wink_threshold [emg_data,emg_t] = getdata(ai,actualRate/dataRate); t = toc; %concatenate all data all_data = [all_data; emg_data]; all_t = [all_t; emg_t]; draw_t = [draw_t; t]; if ~exist('draw_rms','var') draw_rms = []; end draw_rms = [draw_rms; zeros(1,size(emg_data,2))]; for j=1:length(options.ai) draw_rms(end,j) = sqrt(mean(emg_data(:,j).^2)); % draw_rms = [draw_rms; sqrt(mean(emg_data(:,1).^2)) sqrt(mean(emg_data(:,2).^2))]; end if ~isempty(draw_y) draw_y = [draw_y; filter_alpha*draw_y(end,:) + (1-filter_alpha)*(draw_rms(end,:))]; else draw_y = draw_rms(end,:); end end given_command = command_list(i); stop(ai); nSamples = length(draw_rms); window_idx = floor(nSamples*.20); if window_idx == 0 window_idx = 1; end window = draw_rms(window_idx:end,:); % classifier if ((max(window(:,1)))&gt; l_threshold) &amp;&amp; ((max(window(:,2)))&lt; r_threshold) &amp;&amp; ((max(window(:,3)))&lt; f_threshold) movement = 'Left'; elseif (max(window(:,1))&lt; l_threshold) &amp;&amp; (max(window(:,2))&gt; r_threshold)&amp;&amp;(max(window(:,3))&lt; f_threshold) movement = 'Right'; elseif (max(window(:,1))&gt; l_threshold) &amp;&amp; (max(window(:,2))&gt;r_threshold) &amp;&amp; (max(window(:,3))&gt; f_threshold) movement = 'Forward'; elseif (max(window(:,1))&gt; l_threshold) &amp;&amp; (max(window(:,2))&gt; r_threshold&amp; max)(window(:, 3))&lt; f_threshold) movement = 'Backward'</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a586fb139691a74f4c1d12aa1f303cf67"></a><!-- doxytag: member="LRFB_3.m::movement" ref="a586fb139691a74f4c1d12aa1f303cf67" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">else <a class="el" href="_l_r_f_b__3_8m.html#a586fb139691a74f4c1d12aa1f303cf67">movement</a> = 'Unknown'</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="aed9114e5a38b269f8d9e9fd2dd0e0718"></a><!-- doxytag: member="LRFB_3.m::nChoices" ref="aed9114e5a38b269f8d9e9fd2dd0e0718" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">for bit calculations later <a class="el" href="_l_r_f_b__3_8m.html#aed9114e5a38b269f8d9e9fd2dd0e0718">nChoices</a> = length(<a class="el" href="_l_r_f_b__3_8m.html#a7808395ca4c3cf5e653a06847bf824d2">commands</a>)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a378bba22dc311c92029e044abb0f7745"></a><!-- doxytag: member="LRFB_3.m::nCorrect" ref="a378bba22dc311c92029e044abb0f7745" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_l_r_f_b__3_8m.html#a378bba22dc311c92029e044abb0f7745">nCorrect</a> = 0</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a2049522569a53f1bf217d1933e479ab2"></a><!-- doxytag: member="LRFB_3.m::nListReps" ref="a2049522569a53f1bf217d1933e479ab2" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">should <a class="el" href="set_unlock_params_8m.html#aeebc780ad292b8ff1c982e06baffc353">be</a> divisible by <a class="el" href="_l_r_f_b__3_8m.html#a2049522569a53f1bf217d1933e479ab2">nListReps</a> = ceil(<a class="el" href="_l_r_f_b__3_8m.html#aef7ddecebe461a4a235f0e2094aa5b9f">nTrials</a>/length(<a class="el" href="_l_r_f_b__3_8m.html#a7808395ca4c3cf5e653a06847bf824d2">commands</a>))</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="aef7ddecebe461a4a235f0e2094aa5b9f"></a><!-- doxytag: member="LRFB_3.m::nTrials" ref="aef7ddecebe461a4a235f0e2094aa5b9f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_l_r_f_b__3_8m.html#aef7ddecebe461a4a235f0e2094aa5b9f">nTrials</a> = 12</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a58ab1fd68e97078232808206b850161b"></a><!-- doxytag: member="LRFB_3.m::on" ref="a58ab1fd68e97078232808206b850161b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">hold <a class="el" href="_l_r_f_b__3_8m.html#a58ab1fd68e97078232808206b850161b">on</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a02eacfd40be9042ceb0f07547365203d"></a><!-- doxytag: member="LRFB_3.m::options" ref="a02eacfd40be9042ceb0f07547365203d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_l_r_f_b__3_8m.html#a02eacfd40be9042ceb0f07547365203d">options</a> = paramSetupLRFB</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a52027d4bb6d4a8d84b970aa2674b9f96"></a><!-- doxytag: member="LRFB_3.m::r_threshold" ref="a52027d4bb6d4a8d84b970aa2674b9f96" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_l_r_f_b__3_8m.html#a52027d4bb6d4a8d84b970aa2674b9f96">r_threshold</a> = <a class="el" href="_l_r_f_b__3_8m.html#ab46eeb0d31997a550d9c614012220383">max</a>(<a class="el" href="_calibrate___l_r_f_b_8m.html#acc96488446976d1b30ae76ca72ecb909">draw_rms</a>(:,2))</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a91106fc2280d1762b29c56f191342e79"></a><!-- doxytag: member="LRFB_3.m::reorder_idx" ref="a91106fc2280d1762b29c56f191342e79" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">randomizes <a class="el" href="_l_r_f_b__3_8m.html#a91106fc2280d1762b29c56f191342e79">reorder_idx</a> = randperm(size(<a class="el" href="_l_r_f_b__3_8m.html#a622badbc988ce65ebb3b4c1c8eb197b4">command_list</a>,1))</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="af7449f4e1bb7fd701d8a3ead5f0da5a1"></a><!-- doxytag: member="LRFB_3.m::return" ref="af7449f4e1bb7fd701d8a3ead5f0da5a1" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">else <a class="el" href="_l_r_f_b__3_8m.html#af7449f4e1bb7fd701d8a3ead5f0da5a1">return</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="afd1453cad6368d31b07391d3fad93f5d"></a><!-- doxytag: member="LRFB_3.m::RMF" ref="afd1453cad6368d31b07391d3fad93f5d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">end for loop to plot <a class="el" href="_l_r_f_b__3_8m.html#afd1453cad6368d31b07391d3fad93f5d">RMF</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a7bcc24c4bf38cb51a0dbc14e7cb1b1a9"></a><!-- doxytag: member="LRFB_3.m::RMS" ref="a7bcc24c4bf38cb51a0dbc14e7cb1b1a9" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_l_r_f_b__3_8m.html#a7bcc24c4bf38cb51a0dbc14e7cb1b1a9">RMS</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a57c08380e17d03eeac0cbe05897ce51d"></a><!-- doxytag: member="LRFB_3.m::sampleRate" ref="a57c08380e17d03eeac0cbe05897ce51d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">timing definitions <a class="el" href="_l_r_f_b__3_8m.html#a57c08380e17d03eeac0cbe05897ce51d">sampleRate</a> = 4000</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a05b56bc109d79e5ad0860e4ff071e9d9"></a><!-- doxytag: member="LRFB_3.m::SamplesPerTrigger" ref="a05b56bc109d79e5ad0860e4ff071e9d9" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_l_r_f_b__3_8m.html#ad10e0d7b5cffc3ec9200126b0128aaae">ai</a> <a class="el" href="_l_r_f_b__3_8m.html#a05b56bc109d79e5ad0860e4ff071e9d9">SamplesPerTrigger</a> = Inf</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="aa38deece9821742b2aa3d7f5145c6414"></a><!-- doxytag: member="LRFB_3.m::STARTING" ref="aa38deece9821742b2aa3d7f5145c6414" args="[wPtr, rect]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_l_r_f_b__3_8m.html#aa38deece9821742b2aa3d7f5145c6414">STARTING</a>[wPtr, rect] = Screen('OpenWindow',<a class="el" href="_l_r_f_b__3_8m.html#a3b51c79a7f111d2be9d347ac9bfe3abd">win</a>,bkg_color,<a class="el" href="_l_r_f_b__3_8m.html#a19d18510a1713030f345eb97dd5a573c">dims</a>)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="ac399c2ccc3e97e40664302b5d606ddac"></a><!-- doxytag: member="LRFB_3.m::subject_id" ref="ac399c2ccc3e97e40664302b5d606ddac" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pulls up GUI CHANGE EACH TIME <a class="el" href="_l_r_f_b__3_8m.html#ac399c2ccc3e97e40664302b5d606ddac">subject_id</a> = options.subject_ID</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="af5a50986527724aac6d11ec9465b5f39"></a><!-- doxytag: member="LRFB_3.m::t_end" ref="af5a50986527724aac6d11ec9465b5f39" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_l_r_f_b__3_8m.html#af5a50986527724aac6d11ec9465b5f39">t_end</a> = Screen(wPtr,'Flip')</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a8fb092330ecda60587643305d0d9738a"></a><!-- doxytag: member="LRFB_3.m::tic" ref="a8fb092330ecda60587643305d0d9738a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_l_r_f_b__3_8m.html#a8fb092330ecda60587643305d0d9738a">tic</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a70ad662d5e697eaad0ee3afe3ea0b234"></a><!-- doxytag: member="LRFB_3.m::total_t" ref="a70ad662d5e697eaad0ee3afe3ea0b234" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_l_r_f_b__3_8m.html#a70ad662d5e697eaad0ee3afe3ea0b234">total_t</a> = 0</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a0f699a39e02b66ae6fbc4ef115970527"></a><!-- doxytag: member="LRFB_3.m::wait_color" ref="a0f699a39e02b66ae6fbc4ef115970527" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_l_r_f_b__3_8m.html#a0f699a39e02b66ae6fbc4ef115970527">wait_color</a> = 255</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a3b51c79a7f111d2be9d347ac9bfe3abd"></a><!-- doxytag: member="LRFB_3.m::win" ref="a3b51c79a7f111d2be9d347ac9bfe3abd" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_l_r_f_b__3_8m.html#a3b51c79a7f111d2be9d347ac9bfe3abd">win</a> = 1</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a5aca3cfdfee68980538a2a1b58545654"></a><!-- doxytag: member="LRFB_3.m::wink_threshold" ref="a5aca3cfdfee68980538a2a1b58545654" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_l_r_f_b__3_8m.html#a5aca3cfdfee68980538a2a1b58545654">wink_threshold</a> = <a class="el" href="_l_r_f_b__3_8m.html#ab46eeb0d31997a550d9c614012220383">max</a>(<a class="el" href="_calibrate___l_r_f_b_8m.html#acc96488446976d1b30ae76ca72ecb909">draw_rms</a>(:,4))</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Mon Nov 10 2014 11:09:10 for The Unlock Project by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
